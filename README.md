# Demo PVZ-Service

### Coverage:
> **üî∂ - 81%**

### –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ:

- [–°—Ç–∞—Ä—Ç –≤—Ä—É—á–Ω—É—é](#title1);
- [–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker(–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ)](#title2);
- [–ö–∞–∫ –±—ã–ª–æ "–ó–∞–≥—Ä—É–º–ª–µ–Ω–æ" —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ?](#title2);
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã](#title3).

---

### üîπ<a id="title1">–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</a>: üõ†

**–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:**

1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Postgres (–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ë–î):

```bash
sudo -u postgres psql
CREATE ROLE pvz_avito WITH LOGIN PASSWORD 'qwerty';
CREATE DATABASE pvz_avito_service OWNER pvz_avito;
GRANT ALL PRIVILEGES ON DATABASE pvz_avito_service TO pvz_avito;
\q
```

–ï—Å–ª–∏ –¥–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –µ—â–µ –Ω–µ—Ç, —Ç–æ –≤—Å–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ —Ö–æ—Ä–æ—à–æ

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç —Å—Ä–∞–±–æ—Ç–∞–ª –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ sudo –µ—â–µ —Ä–∞–∑, –∞ –ø–æ—Ç–æ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ –µ—â–µ —Ä–∞–∑

**–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Postgres –∏ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ), –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**

```bash
sudo service postgresql restart  # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Postgres
```

```bash
psql -h 127.0.0.1 -U pvz_avito -d pvz_avito_service  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç:

```bash
python3 -m venv .venv
source .venv/bin/activate
```

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞, –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π, –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –≤—ã–±–æ—Ä –Ω–∞
Select existing**

```bash
pip install -r requirements.txt
python src/main.py
```

---

### üîπ<a id="title2">–ó–∞–ø—É—Å–∫ –≤ Docker</a>: üõ†

### **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –∑–∞–ø—É—Å–∫**

**–ß—Ç–æ–±—ã –≤—Å–µ —Ä–∞–±–æ—Ç–∞–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å postgres-—Å–µ—Ä–≤–∏—Å—ã, –≤–æ –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:**

–í–æ–∑–º–æ–∂–Ω—ã–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç: exposing port TCP 0.0.0.0:5432 -> 127.0.0.1:0: listen tcp 0.0.0.0:5432: bind: address already in
use

–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è Ubuntu:

```bash
sudo systemctl stop postgresql 
```

–ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã:

```bash
sudo systemctl start postgresql 
```

----------------------------------------------------------------------------------------------------------------------------
---

**–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ Docker:**

```bash
docker compose -f deploy/local/docker-compose.yml up -d --build  
```

**–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å**

```bash
docker compose -f deploy/local/docker-compose.yml down
```

----------------------------------------------------------------------------------------------------------------------------
---
**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã**

```bash
docker ps -a
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**

```bash
docker compose -f deploy/local/docker-compose.yml logs app
docker compose -f deploy/local/docker-compose.yml logs db
```

---


### üîπ<a id="title3">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã</a>: üõ†

#### –õ–∏–Ω—Ç–µ—Ä:

```bash
flake8 ./
```

---

#### –¢–∏–ø–∏–∑–∞—Ç–æ—Ä:

```bash
mypy ./
```

---

#### –¢–µ—Å—Ç—ã:

```bash
pytest -v
```

---
